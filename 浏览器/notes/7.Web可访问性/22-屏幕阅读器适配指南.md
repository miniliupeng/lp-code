# 22-屏幕阅读器适配指南

屏幕阅读器是一种将屏幕上显示的内容（文本、按钮、图片等）转换成语音或盲文输出的辅助技术软件。它是视力障碍用户访问数字世界的主要工具。作为开发者，我们的目标是提供清晰、结构化的信息，让屏幕阅读器能够准确地向用户传达页面的内容和功能。

屏幕阅读器并非直接读取 DOM，而是与浏览器协同工作，解析一个名为**可访问性树 (Accessibility Tree)** 的结构。这棵树由 DOM 树和 ARIA 信息共同构成，专门为辅助技术提供语义信息。我们的任务就是确保这棵树是完整和有意义的。

以下是一系列确保良好屏幕阅读器体验的核心实践。

## 1. 为所有有意义的图片提供替代文本

这是最基本、也最重要的规则之一。如果一张图片传递了有用的信息，它必须有一个文本替代方案。

*   **使用 `alt` 属性**：
    ```html
    <!-- 好的示例 -->
    <img src="chart.png" alt="一张柱状图，显示第二季度销售额增长了 20%">
    ```
    *   **`alt` 文本应该**：简洁、准确地描述图片的核心**信息**或**目的**，而不是简单地描述图片本身（例如，不要写 `alt="一张图"`）。

*   **处理装饰性图片**：
    *   如果一张图片纯粹是用于装饰，不传递任何实际信息，应该给它一个**空的 `alt` 属性** (`alt=""`)。
    *   这样，屏幕阅读器会**完全跳过**这张图片，而不会读出冗余的文件名（如 `alt` 属性缺失时可能发生的情况）。
    ```html
    <!-- 好的示例：装饰性背景图 -->
    <img src="background-pattern.png" alt="">
    ```

## 2. 保证链接和按钮的文本是描述性的

屏幕阅读器用户经常使用快捷键来列出页面上所有的链接或按钮，以便快速导航。

*   **避免模糊的文本**：
    ```html
    <!-- 不好的示例 -->
    <a href="/news/article-1">点击这里</a> 阅读更多

    <!-- 好的示例 -->
    <a href="/news/article-1">阅读更多关于“浏览器性能优化”的文章</a>
    ```
    *   模糊的“点击这里”或“阅读更多”在脱离上下文后，用户完全不知道它会导航到哪里。链接文本本身应该清晰地说明其目的。

*   **为图标按钮提供可访问的名称**：
    *   对于只有图标、没有可见文本的按钮，必须使用 `aria-label` 来提供一个对屏幕阅读器友好的文本标签。
    ```html
    <!-- 好的示例 -->
    <button aria-label="关闭">&times;</button>
    <button aria-label="搜索"><svg>...</svg></button>
    ```

## 3. 为所有表单控件关联 `<label>`

这是确保表单可访问性的核心。`<label>` 标签的作用是告诉用户（包括屏幕阅读器用户）这个输入框是用来做什么的。

```html
<!-- 最佳实践：使用 for 和 id 属性关联 -->
<label for="username">用户名:</label>
<input type="text" id="username">

<!-- 也可以通过将 input 包裹在 label 中来实现关联 -->
<label>
  密码:
  <input type="password" name="password">
</label>
```
没有 `<label>` 的输入框，对于屏幕阅读器用户来说就是一个“身份不明”的输入框。

## 4. 使用 ARIA Live Regions 播报动态内容

当页面内容通过 JavaScript 动态更新时（例如，表单验证失败的错误提示、新消息通知、搜索结果的加载），屏幕阅读器默认是**不知道**这些变化的。

**ARIA Live Regions** 允许我们“礼貌地”通知屏幕阅读器，页面的某一部分发生了更新，请将更新的内容朗读给用户。

*   **`aria-live` 属性**：
    *   `aria-live="polite"` (礼貌的): **最常用**。屏幕阅读器会在**完成当前朗读任务后**，再播报更新的内容。适用于大多数非紧急的通知。
    *   `aria-live="assertive"` (断言的): 屏幕阅读器会**立即中断**当前的朗读，紧急播报更新的内容。只应用于非常重要的、需要立即引起用户注意的更新（如“会话即将超时”）。

**示例：表单错误提示**
```html
<div id="error-container" aria-live="polite"></div>

<script>
  function showError(message) {
    const errorContainer = document.getElementById('error-container');
    errorContainer.textContent = message;
  }
  // 当验证失败时调用: showError('请输入有效的邮箱地址');
</script>
```
当 `showError` 函数被调用时，屏幕阅读器会自动朗读出“请输入有效的邮箱地址”。

## 5. 正确地隐藏内容

有时我们需要在视觉上隐藏内容，但希望它仍然能被屏幕阅读器访问（反之亦然）。

*   **仅在视觉上隐藏 (屏幕阅读器可访问)**：
    *   **目的**：为屏幕阅读器用户提供额外的上下文信息，例如“跳转到主内容”的隐藏链接。
    *   **方法**：使用 CSS 将元素移出屏幕可视范围。
    ```css
    .visually-hidden {
      position: absolute;
      left: -10000px;
      top: auto;
      width: 1px;
      height: 1px;
      overflow: hidden;
    }
    ```

*   **完全隐藏 (屏幕阅读器和视觉上都不可见)**：
    *   **方法**：
        *   `display: none;`
        *   `visibility: hidden;`
    *   这两种方法会将元素从可访问性树中移除，屏幕阅读器将完全忽略它们。

*   **仅对屏幕阅读器隐藏**：
    *   **方法**：使用 `aria-hidden="true"`。
    *   **作用**：将元素及其所有子元素从可访问性树中移除，但**不影响其视觉表现**。
    *   **何时使用**：当一个元素纯粹是装饰性的，或者它的功能/信息已由其他地方的文本清晰描述时（例如，一个图标旁边已经有了明确的文字“设置”）。

## 6. 利用地标 (Landmarks) 进行导航

再次强调语义化 HTML 的重要性。使用 `<header>`, `<nav>`, `<main>`, `<aside>`, `<footer>` 等地标元素，会自动为页面创建结构化的导航点。屏幕阅读器用户可以通过快捷键在这些地标之间快速跳转，这是他们概览和导航页面的最高效方式。
